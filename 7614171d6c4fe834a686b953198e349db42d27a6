{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "a63cf001_6bf059a4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000278
      },
      "writtenOn": "2024-11-19T19:11:57Z",
      "side": 1,
      "message": "Ed,\nWill you please expound upon the problem you\u0027re seeing?\nWhat is your network config?\nI assume you have two NICs, one of which is USB?\nWhat stops working?\n\nI have my SUT with the dedicated BMC NIC at eth0, and an NCSI NIC at eth1.\nSubmitting this to the BMC, after disabling DHCP to eth1:\nPATCH :url/redfish/v1/Managers/bmc/EthernetInterfaces/eth1\n     \"IPv4StaticAddresses\": [\n     {\n             \"Address\": \"192.168.20.3\",\n             \"SubnetMask\": \"255.255.255.0\",\n             \"Gateway\": \"192.168.20.1\"\n     }\n     ]\nResults in:\ndefault via 192.168.20.1 dev eth1 onlink\nlink/ether bc:6e:e2:00:0a:a0 brd ff:ff:ff:ff:ff:ff\ndefault via 10.243.48.1 dev eth0  src 10.243.48.31  metric 1024\n\nAnd traffic still passes to both networks.",
      "revId": "7614171d6c4fe834a686b953198e349db42d27a6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "35aea116_37287886",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-19T19:21:32Z",
      "side": 1,
      "message": "That\u0027s not the behavior I\u0027m seeing.  If I do almost an identical command to what you have, the default gateway you show above doesn\u0027t exist, only the local links.\n\ni\u0027m using a 172.x.x.x address.... not sure if that could be different?\n\nlet me play around some more.",
      "parentUuid": "a63cf001_6bf059a4",
      "revId": "7614171d6c4fe834a686b953198e349db42d27a6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "20b11f87_10a0f80b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000278
      },
      "writtenOn": "2024-11-19T19:45:05Z",
      "side": 1,
      "message": "I seriously doubt a 172.x addr matters.\nI did notice that the phos-net SHA you provided didn\u0027t write the configuration back to /etc/systemd/network/ network.config file.\nA newer version of phos-net does perform that action.\nIt both stores the new config, and then reloads the config.\nPerhaps you aren\u0027t on a new enough version?",
      "parentUuid": "35aea116_37287886",
      "revId": "7614171d6c4fe834a686b953198e349db42d27a6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f239d371_584a5cb6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-26T00:10:01Z",
      "side": 1,
      "message": "I pulled, and am still seeing the same behavior.  At dbus level, if I set up a static up with a gatewway, the default route stays the same:\n\nbusctl call xyz.openbmc_project.Network /xyz/openbmc_project/network/eth0 xyz.openbmc_project.Network.IP.Create IP ssys xyz.openbmc_project.Network.IP.Protocol.IPv4 192.168.7.2 24 192.168.7.1\n\nbusctl set-property xyz.openbmc_project.Network /xyz/openbmc_project/network/eth0 xyz.openbmc_project.Network.EthernetInterface DefaultGateway s 192.168.7.1\n\n\nNow, at Johnathans guess, I tried changing the DHCP:\nbusctl set-property xyz.openbmc_project.Network /xyz/openbmc_project/network/eth0 xyz.openbmc_project.Network.EthernetInterface DHCP4 b false\n\nand that does trigger the route to be created.  What I don\u0027t understand is why the second call doesn\u0027t fail?  If we\u0027re in DHCP and the gateway fully intends to not be written why does the property set succeed?",
      "parentUuid": "20b11f87_10a0f80b",
      "revId": "7614171d6c4fe834a686b953198e349db42d27a6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "22cb121a_89b06f86",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-26T21:53:14Z",
      "side": 1,
      "message": "I found the DHCP code that is the real root cause of this.  I suspect the long term answer is that we need to support the UseDHCP parameter defined in Redfish, but that\u0027s not what this change does, so abandoning.",
      "revId": "7614171d6c4fe834a686b953198e349db42d27a6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}